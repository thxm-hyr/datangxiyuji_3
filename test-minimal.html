<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>最小测试页面</title>
    <style>
        body {
            font-family: '宋体', serif;
            margin: 0;
            padding: 20px;
            background: #f8f4e9;
            text-align: center;
        }
        .test-box {
            background: white;
            padding: 20px;
            margin: 20px auto;
            border-radius: 8px;
            border: 2px solid #8b5a2b;
            max-width: 600px;
        }
        .test-button {
            background: #8b5a2b;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin: 10px;
            font-size: 16px;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
        }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .loading { background: #d1ecf1; color: #0c5460; }
    </style>
</head>
<body>
    <h1>《大唐西域记》网站功能测试</h1>
    
    <div class="test-box">
        <h2>基础功能测试</h2>
        <div id="basic-status" class="status loading">测试中...</div>
        <button class="test-button" onclick="testBasic()">重新测试基础功能</button>
    </div>

    <div class="test-box">
        <h2>页面跳转测试</h2>
        <button class="test-button" onclick="window.location.href='index.html'">测试首页</button>
        <button class="test-button" onclick="window.location.href='map.html'">测试地图页</button>
        <button class="test-button" onclick="window.open('map.html', '_blank')">在新窗口打开地图</button>
    </div>

    <div class="test-box">
        <h2>JavaScript测试</h2>
        <div id="js-status" class="status loading">测试中...</div>
        <button class="test-button" onclick="testJavaScript()">测试JavaScript</button>
    </div>

    <div class="test-box">
        <h2>问题诊断</h2>
        <div id="diagnostic-info"></div>
        <button class="test-button" onclick="showDiagnosticInfo()">显示诊断信息</button>
    </div>

    <script>
        // 基础功能测试
        function testBasic() {
            const status = document.getElementById('basic-status');
            status.className = 'status loading';
            status.textContent = '测试中...';
            
            setTimeout(() => {
                let result = '✓ HTML和CSS正常';
                
                // 检查基本功能
                if (typeof document !== 'undefined') {
                    result += ' | ✓ DOM正常';
                } else {
                    result += ' | ✗ DOM异常';
                }
                
                if (navigator.onLine) {
                    result += ' | ✓ 网络连接正常';
                } else {
                    result += ' | ✗ 网络离线';
                }
                
                status.className = 'status success';
                status.textContent = result;
            }, 1000);
        }

        // JavaScript测试
        function testJavaScript() {
            const status = document.getElementById('js-status');
            status.className = 'status loading';
            status.textContent = '测试中...';
            
            setTimeout(() => {
                let result = '';
                
                try {
                    // 测试基本JS功能
                    const testObj = {name: 'test', value: 123};
                    const testArr = [1, 2, 3];
                    
                    result += '✓ 基本语法正常';
                    
                    // 测试事件处理
                    result += ' | ✓ 事件处理正常';
                    
                    status.className = 'status success';
                    status.textContent = result;
                    
                } catch (error) {
                    status.className = 'status error';
                    status.textContent = '✗ JavaScript错误: ' + error.message;
                }
            }, 1000);
        }

        // 显示诊断信息
        function showDiagnosticInfo() {
            const info = document.getElementById('diagnostic-info');
            
            const diagnosticInfo = `
                <h3>浏览器信息</h3>
                <p><strong>用户代理:</strong> ${navigator.userAgent}</p>
                <p><strong>在线状态:</strong> ${navigator.onLine ? '在线' : '离线'}</p>
                <p><strong>语言:</strong> ${navigator.language}</p>
                <p><strong>平台:</strong> ${navigator.platform}</p>
                
                <h3>页面信息</h3>
                <p><strong>URL:</strong> ${window.location.href}</p>
                <p><strong>协议:</strong> ${window.location.protocol}</p>
                <p><strong>主机:</strong> ${window.location.host}</p>
                
                <h3>JavaScript能力</h3>
                <p><strong>Cookie支持:</strong> ${navigator.cookieEnabled ? '是' : '否'}</p>
                <p><strong>Java支持:</strong> ${navigator.javaEnabled ? '是' : '否'}</p>
            `;
            
            info.innerHTML = diagnosticInfo;
        }

        // 页面加载时自动运行基础测试
        window.onload = function() {
            testBasic();
            testJavaScript();
            showDiagnosticInfo();
        };

        // 控制台输出诊断信息
        console.log('=== 网站诊断信息 ===');
        console.log('页面URL:', window.location.href);
        console.log('在线状态:', navigator.onLine);
        console.log('用户代理:', navigator.userAgent);
        console.log('=== 诊断结束 ===');
    </script>
</body>
</html>